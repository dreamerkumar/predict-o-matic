# predict_december_2025.py

## Purpose

This script generates **sales predictions for December 2025** using the Hybrid Machine Learning Model (Random Forest for VAS_Sold + Linear Regression for Speed_Upgrades). It loads the trained models, applies them to December 2025 test data, and produces detailed predictions with visualizations showing cumulative day-over-day sales forecasts.

## What It Does

1. **Loads Training Data**: Reads `final_dataset.csv` to train the hybrid models
2. **Trains Models**:
   - Random Forest model for VAS_Sold predictions
   - Linear Regression model for Speed_Upgrades predictions
3. **Loads Test Data**: Reads `test_dataset_dec_2025.csv` containing December 2025 marketing campaigns
4. **Feature Engineering**: Applies the same transformations as training data (holidays, temporal features, etc.)
5. **Generates Predictions**: Produces daily forecasts for both VAS_Sold and Speed_Upgrades
6. **Creates Visualizations**: 
   - Cumulative line charts showing day-over-day growth
   - Highlights marketing campaign days with star markers
   - Displays milestone annotations and final totals
7. **Saves Results**: Outputs detailed predictions CSV and visualization chart

## Prerequisites

### Required Files
- **`final_dataset.csv`**: Historical training data (Sep 2024 - Oct 2025)
- **`test_dataset_dec_2025.csv`**: December 2025 test data with marketing campaigns
  - Generated by `create_test_dataset_updated.py`
  - Must contain: Date, Channel, Emails_Sent, Push_Notifications_Sent

### Required Python Packages
```bash
pip install pandas numpy scikit-learn matplotlib
```

**Dependencies:**
- `pandas`: Data manipulation
- `numpy`: Numerical computations
- `scikit-learn`: Machine learning models
- `matplotlib`: Visualization

## How to Run

### Standard Workflow

**Step 1: Generate Test Dataset (if not already created)**
```bash
python create_test_dataset_updated.py
```

**Step 2: Run Predictions**
```bash
cd /path/to/telecom-sales-predictor
python predict_december_2025.py
```

### Expected Output
The script displays:
1. **Training Progress** [1/5]:
   - Loading training data confirmation
   - Number of training records
2. **Model Training** [2/5 & 3/5]:
   - Random Forest training for VAS_Sold
   - Linear Regression training for Speed_Upgrades
3. **Test Data Loading** [4/5]:
   - Test records count
   - Date range (Dec 1-31, 2025)
4. **Predictions** [5/5]:
   - Prediction completion confirmation
5. **December 2025 Summary**:
   - Total VAS_Sold predicted
   - Total Speed_Upgrades predicted
   - Daily averages, min, and max
6. **Top 5 Days**:
   - Best days for VAS_Sold with push notification volumes
   - Best days for Speed_Upgrades with email volumes
7. **File Save Confirmation**:
   - Path to detailed predictions CSV
   - Path to visualization chart

### Output Files

#### 1. Detailed Predictions CSV
**Filename**: `output_files/december_2025_predictions_<timestamp>.csv`

**Structure**:
```csv
Date,Channel,VAS_Sold_Predicted,Speed_Upgrades_Predicted,Emails_Sent,Push_Notifications_Sent
12/01/2025,App,45,52,0,0
12/01/2025,Web,38,61,0,0
12/02/2025,App,145,54,0,150000
12/02/2025,Web,42,65,0,0
...
```

**Columns**:
- `Date`: Date in MM/DD/YYYY format
- `Channel`: App or Web
- `VAS_Sold_Predicted`: Predicted VAS sales (rounded to nearest integer)
- `Speed_Upgrades_Predicted`: Predicted speed upgrades (rounded to nearest integer)
- `Emails_Sent`: Marketing emails sent that day
- `Push_Notifications_Sent`: Push notifications sent that day

#### 2. Visualization Chart
**Filename**: `output_files/december_2025_predictions_chart_<timestamp>.png`

**Features**:
- **Two Subplots**: VAS_Sold (top) and Speed_Upgrades (bottom)
- **Cumulative Lines**: Shows running totals throughout December
- **Campaign Day Markers**: Gold stars indicating marketing push days
- **Milestone Annotations**: Labels at 5-day intervals showing cumulative totals
- **Final Totals**: Prominent annotation at end of month
- **Color Coding**:
  - VAS_Sold: Blue (#2E86AB)
  - Speed_Upgrades: Purple (#A23B72)
  - Campaign markers: Gold/Orange stars
- **Optimized File Size**: 100 DPI for efficient transmission (files ~200-400 KB, under 1 MB for MCP compatibility)

## Example Output Summary

```
================================================================================
DECEMBER 2025 PREDICTIONS SUMMARY
================================================================================

VAS_Sold:
  Total for December: 12,450
  Daily Average: 401.6
  Min Daily: 180
  Max Daily: 620

Speed_Upgrades:
  Total for December: 8,920
  Daily Average: 287.7
  Min Daily: 240
  Max Daily: 380

--------------------------------------------------------------------------------
TOP 5 DAYS BY VAS_SOLD:
  12/10/2025: 620 VAS (Push: 175,000)
  12/15/2025: 580 VAS (Push: 150,000)
  12/20/2025: 545 VAS (Push: 125,000)
  12/05/2025: 510 VAS (Push: 100,000)
  12/02/2025: 485 VAS (Push: 150,000)

TOP 5 DAYS BY SPEED_UPGRADES:
  12/18/2025: 380 Upgrades (Emails: 250,000)
  12/12/2025: 365 Upgrades (Emails: 225,000)
  12/22/2025: 350 Upgrades (Emails: 200,000)
  12/08/2025: 340 Upgrades (Emails: 200,000)
  12/28/2025: 335 Upgrades (Emails: 175,000)
```

## Dependencies on Other Files

### Direct Dependencies
1. **`final_dataset.csv`** (required): Historical training data
   - Used to train both prediction models
   - Must be in the same directory

2. **`test_dataset_dec_2025.csv`** (required): December 2025 test data
   - Generated by `create_test_dataset_updated.py`
   - Contains marketing campaign schedule

### Related Scripts
- **`create_test_dataset_updated.py`**: Generates the required test dataset
- **`analyze_data_hybrid.py`**: Uses same hybrid model architecture (informational, not a dependency)

### Directory Structure
```
telecom-sales-predictor/
├── predict_december_2025.py                # This script
├── final_dataset.csv                       # Required: training data
├── test_dataset_dec_2025.csv              # Required: test data
└── output_files/                           # Created automatically
    ├── december_2025_predictions_<timestamp>.csv
    └── december_2025_predictions_chart_<timestamp>.png
```

## Model Details

### Random Forest Configuration (VAS_Sold)
```python
RandomForestRegressor(
    n_estimators=200,
    max_depth=15,
    min_samples_split=5,
    min_samples_leaf=2,
    max_features='sqrt',
    random_state=42,
    n_jobs=-1
)
```

### Linear Regression Configuration (Speed_Upgrades)
```python
LinearRegression()  # Default parameters
```

### Feature Set Used
```python
features = [
    'Day_of_Year',              # 1-365
    'Day_of_Week',              # 0-6 (Monday-Sunday)
    'Month',                    # 1-12
    'Channel_Encoded',          # 0=App, 1=Web
    'Emails_Sent',              # Marketing emails
    'Push_Notifications_Sent',  # Push notifications
    'Is_Holiday',               # 0 or 1
    'Days_To_Holiday',          # Days until next holiday
    'Days_From_Holiday',        # Days since last holiday
    'Near_Holiday'              # Within 1 day of holiday
]
```

## Holiday Recognition

### December 2025 Holidays
- **December 25, 2025**: Christmas
  - Script automatically identifies this as a federal holiday
  - Calculates proximity features for prediction models

### Impact on Predictions
- Days marked as holidays may show different sales patterns
- "Near holiday" flag captures day-before and day-after effects
- Useful for predicting Christmas shopping behavior

## Troubleshooting

### Common Issues

1. **FileNotFoundError: final_dataset.csv not found**
   - Ensure `final_dataset.csv` exists in the directory
   - This file contains the training data

2. **FileNotFoundError: test_dataset_dec_2025.csv not found**
   - Run `create_test_dataset_updated.py` first to generate this file
   - Or ensure the file exists in the same directory

3. **Value Error: could not convert string to float**
   - Check that test dataset has numeric values for Emails_Sent and Push_Notifications_Sent
   - Verify CSV format matches expected structure

4. **Predictions Look Unrealistic**
   - Verify training data quality (no null values, realistic ranges)
   - Check that test dataset has appropriate marketing volumes
   - Review campaign schedule in test dataset

5. **Chart Not Displaying Campaign Markers**
   - Ensure test dataset has non-zero values for marketing columns
   - Check that dates with campaigns have Emails_Sent > 0 or Push_Notifications_Sent > 0

## Customization Options

### Modify Date Range
To predict a different month, edit test dataset generation:
```python
# In create_test_dataset_updated.py
start_date = datetime(2026, 1, 1)  # January 2026
end_date = datetime(2026, 1, 31)
```

### Adjust Model Parameters
To tune model performance, modify hyperparameters:
```python
# Increase trees for better accuracy (slower)
model_vas = RandomForestRegressor(n_estimators=500, ...)

# Change learning rate
model_upgrades = LinearRegression(...)  # Limited customization for LR
```

### Change Visualization Style
Modify chart appearance:
```python
# Change colors
color='#YOUR_COLOR_CODE'

# Adjust figure size
fig, axes = plt.subplots(2, 1, figsize=(20, 14))

# Modify DPI (default is 100 for efficient file size)
plt.savefig(output_chart, dpi=150)  # Slightly higher resolution (larger file)
```

## Performance Notes

- **Execution Time**: Typically 5-10 seconds on modern hardware
- **Memory Usage**: ~200-500 MB during training and prediction
- **Accuracy**: Based on hybrid model test set performance:
  - VAS_Sold: ~86% R² score
  - Speed_Upgrades: ~80% R² score

## Use Cases

1. **Sales Forecasting**: Predict December holiday sales based on planned marketing
2. **Campaign Planning**: Test different marketing scenarios by adjusting test dataset
3. **Resource Planning**: Use predictions for inventory and staffing decisions
4. **Budget Allocation**: Compare predicted ROI across different campaign schedules
5. **Executive Reporting**: Generate professional visualizations for stakeholders

## Notes

- Predictions are **rounded to nearest integer** (can't sell fractional items)
- **Cumulative visualization** makes it easy to track month-to-date progress
- **Campaign markers** help correlate marketing efforts with predicted spikes
- **Timestamps in filenames** allow tracking multiple prediction scenarios
- The script **retrains models** each time it runs (ensures consistency with latest training data)
- **Images are optimized at 100 DPI** to keep file sizes ~200-400 KB for efficient MCP transmission and Cloud Desktop compatibility (< 1 MB limit)

